<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>COSMOS: cosmos_d.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">COSMOS
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">cosmos_d.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;iomanip&gt;</code><br />
<code>#include &lt;fstream&gt;</code><br />
<code>#include &lt;sstream&gt;</code><br />
<code>#include &lt;cmath&gt;</code><br />
<code>#include &lt;cfloat&gt;</code><br />
<code>#include &lt;cstring&gt;</code><br />
<code>#include &quot;cosmos.h&quot;</code><br />
<code>#include &quot;ahf2d.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for cosmos_d.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="cosmos__d_8cpp__incl.png" border="0" usemap="#acosmos__d_8cpp" alt=""/></div>
<map name="acosmos__d_8cpp" id="acosmos__d_8cpp">
<area shape="rect" title=" " alt="" coords="348,5,454,32"/>
<area shape="rect" title=" " alt="" coords="5,80,77,107"/>
<area shape="poly" title=" " alt="" coords="348,32,93,82,92,77,347,27"/>
<area shape="rect" title=" " alt="" coords="101,80,168,107"/>
<area shape="poly" title=" " alt="" coords="355,35,183,81,182,76,353,30"/>
<area shape="rect" title=" " alt="" coords="191,80,256,107"/>
<area shape="poly" title=" " alt="" coords="371,35,270,76,268,71,369,30"/>
<area shape="rect" title=" " alt="" coords="280,80,349,107"/>
<area shape="poly" title=" " alt="" coords="388,35,342,72,339,68,384,30"/>
<area shape="rect" title=" " alt="" coords="372,80,430,107"/>
<area shape="poly" title=" " alt="" coords="404,33,404,64,398,64,398,33"/>
<area shape="rect" title=" " alt="" coords="454,80,508,107"/>
<area shape="poly" title=" " alt="" coords="417,31,458,68,454,72,413,35"/>
<area shape="rect" title=" " alt="" coords="532,80,593,107"/>
<area shape="poly" title=" " alt="" coords="430,30,521,71,519,76,428,35"/>
<area shape="rect" title=" " alt="" coords="617,80,695,107"/>
<area shape="poly" title=" " alt="" coords="446,30,602,74,601,79,445,35"/>
<area shape="rect" title=" " alt="" coords="720,80,784,107"/>
<area shape="poly" title=" " alt="" coords="455,27,705,77,704,82,454,32"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af2e605489a657ae790c8647e638e8238" id="r_af2e605489a657ae790c8647e638e8238"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af2e605489a657ae790c8647e638e8238">printpack</a> (<a class="el" href="class_fmv0.html">Fmv0</a> **fmv0, int ln, int pk, int pl, ofstream &amp;filex, ofstream &amp;filey, ofstream &amp;filez, ofstream &amp;filex0z, ofstream &amp;filexy0)</td></tr>
<tr class="memdesc:af2e605489a657ae790c8647e638e8238"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function to call print routines for all active grid layers.  <br /></td></tr>
<tr class="separator:af2e605489a657ae790c8647e638e8238"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e983e9a80d0d458a54647775b556278" id="r_a2e983e9a80d0d458a54647775b556278"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2e983e9a80d0d458a54647775b556278">check_continue_file</a> ( ifstream &amp;fcontinue, bool &amp;fld, bool &amp;scl, int &amp;tab, int &amp;nxmin, int &amp;nxmax, int &amp;nymin, int &amp;nymax, int &amp;nzmin, int &amp;nzmax, int &amp;laymax, int &amp;ln, int *jbs, int *kbs, int *lbs)</td></tr>
<tr class="memdesc:a2e983e9a80d0d458a54647775b556278"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if parameters in the restart file match the current simulation setup.  <br /></td></tr>
<tr class="separator:a2e983e9a80d0d458a54647775b556278"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62d7edea0dd4c86b24de88f3daf396da" id="r_a62d7edea0dd4c86b24de88f3daf396da"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a62d7edea0dd4c86b24de88f3daf396da">output_params</a> ( ofstream &amp;fileall, bool &amp;fld, bool &amp;scl, int &amp;tab, int &amp;nxmin, int &amp;nxmax, int &amp;nymin, int &amp;nymax, int &amp;nzmin, int &amp;nzmax, int &amp;laymax, int &amp;ln, int *jbs, int *kbs, int *lbs)</td></tr>
<tr class="memdesc:a62d7edea0dd4c86b24de88f3daf396da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes essential simulation parameters to the header of the restart file.  <br /></td></tr>
<tr class="separator:a62d7edea0dd4c86b24de88f3daf396da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22a8364bf67f1752d82afb5a5bee7683" id="r_a22a8364bf67f1752d82afb5a5bee7683"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a22a8364bf67f1752d82afb5a5bee7683">initial_read</a> (ifstream &amp;fin, long int &amp;mstep, double &amp;tmax, int &amp;tab, double &amp;amp, int &amp;nxmin, int &amp;nxmax, int &amp;nymin, int &amp;nymax, int &amp;nzmin, int &amp;nzmax, double &amp;xmin, double &amp;xmax, double &amp;ymin, double &amp;ymax, double &amp;zmin, double &amp;zmax, double &amp;cfl, double &amp;cdt, double &amp;etaa, double &amp;etab, double &amp;etabb, double &amp;KOep, int &amp;exg, int &amp;contn, char *file_continue, double &amp;mu, double &amp;kk, double &amp;xi2, double &amp;xi3, double &amp;w3, double &amp;mus, double &amp;kks, double &amp;xi2s, double &amp;xi3s, double &amp;Hb, double &amp;fluidw, double &amp;Mkap, double &amp;bminmod, double &amp;ptintval1, double &amp;ptintval2, double &amp;changept)</td></tr>
<tr class="memdesc:a22a8364bf67f1752d82afb5a5bee7683"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads simulation parameters from the main initialization file (<code>par_ini.d</code>).  <br /></td></tr>
<tr class="separator:a22a8364bf67f1752d82afb5a5bee7683"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45b1eecc3a25ffbc64e3666f6b6e0d57" id="r_a45b1eecc3a25ffbc64e3666f6b6e0d57"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a45b1eecc3a25ffbc64e3666f6b6e0d57">initial_fmr</a> ( ifstream &amp;fin, int &amp;laymax, int *jbs, int *kbs, int *lbs, double *alp_fmr)</td></tr>
<tr class="memdesc:a45b1eecc3a25ffbc64e3666f6b6e0d57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads Fixed Mesh Refinement (FMR) parameters from <code>par_fmr.d</code>.  <br /></td></tr>
<tr class="separator:a45b1eecc3a25ffbc64e3666f6b6e0d57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a372542cc94148e0fa873200daaceaa6e" id="r_a372542cc94148e0fa873200daaceaa6e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a372542cc94148e0fa873200daaceaa6e">ahf_read</a> (ifstream &amp;fin, double &amp;AHFstart, int &amp;ahcint, int &amp;ahpint, int &amp;ntheta, int &amp;nphi, int &amp;ahloop, double &amp;etaah, double &amp;facn, double &amp;err_p, double &amp;err_e, double &amp;ahc)</td></tr>
<tr class="memdesc:a372542cc94148e0fa873200daaceaa6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads Apparent Horizon Finder (AHF) parameters from <code>par_ahf.d</code>.  <br /></td></tr>
<tr class="separator:a372542cc94148e0fa873200daaceaa6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ddf1224851353fc92bfbff6f499fa97" id="r_a0ddf1224851353fc92bfbff6f499fa97"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0ddf1224851353fc92bfbff6f499fa97">main</a> (int argc, char *argv[])</td></tr>
<tr class="memdesc:a0ddf1224851353fc92bfbff6f499fa97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main function for the COSMOS simulation code.  <br /></td></tr>
<tr class="separator:a0ddf1224851353fc92bfbff6f499fa97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a372542cc94148e0fa873200daaceaa6e" name="a372542cc94148e0fa873200daaceaa6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a372542cc94148e0fa873200daaceaa6e">&#9670;&#160;</a></span>ahf_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ahf_read </td>
          <td>(</td>
          <td class="paramtype">ifstream &amp;</td>          <td class="paramname"><span class="paramname"><em>fin</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>AHFstart</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>ahcint</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>ahpint</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>ntheta</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>nphi</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>ahloop</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>etaah</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>facn</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>err_p</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>err_e</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>ahc</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads Apparent Horizon Finder (AHF) parameters from <code>par_ahf.d</code>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fin</td><td>Input file stream for <code>par_ahf.d</code>. </td></tr>
    <tr><td class="paramname">AHFstart</td><td>Simulation time at which to start searching for apparent horizons. </td></tr>
    <tr><td class="paramname">ahcint</td><td>Time step interval between AHF calls. </td></tr>
    <tr><td class="paramname">ahpint</td><td>Time step interval for printing detailed AH information (e.g., shape). </td></tr>
    <tr><td class="paramname">ntheta</td><td>Number of grid points in the theta direction for the AHF surface. </td></tr>
    <tr><td class="paramname">nphi</td><td>Number of grid points in the phi direction for the AHF surface. </td></tr>
    <tr><td class="paramname">ahloop</td><td>Maximum number of iterations allowed for the AHF solver. </td></tr>
    <tr><td class="paramname">etaah</td><td>Relaxation parameter (eta) for the AHF elliptic solver. (Note: parameter name mismatch with variable <code>var</code> in <code>main</code>) </td></tr>
    <tr><td class="paramname">facn</td><td>Mixing factor for using the previous step's solution as an initial guess. </td></tr>
    <tr><td class="paramname">err_p</td><td>Tolerance for the Poisson solver part of the AHF. </td></tr>
    <tr><td class="paramname">err_e</td><td>Tolerance for the main apparent horizon equation solver. </td></tr>
    <tr><td class="paramname">ahc</td><td>Initial guess for the coordinate radius of the apparent horizon.</td></tr>
  </table>
  </dd>
</dl>
<p>Reads parameters controlling the behavior and execution of the apparent horizon finder from the <code>par_ahf.d</code> file. Aborts if the file cannot be opened. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cosmos__d_8cpp_a372542cc94148e0fa873200daaceaa6e_icgraph.png" border="0" usemap="#acosmos__d_8cpp_a372542cc94148e0fa873200daaceaa6e_icgraph" alt=""/></div>
<map name="acosmos__d_8cpp_a372542cc94148e0fa873200daaceaa6e_icgraph" id="acosmos__d_8cpp_a372542cc94148e0fa873200daaceaa6e_icgraph">
<area shape="rect" title="Reads Apparent Horizon Finder (AHF) parameters from par_ahf.d." alt="" coords="103,5,174,32"/>
<area shape="rect" href="cosmos__d_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function for the COSMOS simulation code." alt="" coords="5,5,55,32"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a2e983e9a80d0d458a54647775b556278" name="a2e983e9a80d0d458a54647775b556278"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e983e9a80d0d458a54647775b556278">&#9670;&#160;</a></span>check_continue_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void check_continue_file </td>
          <td>(</td>
          <td class="paramtype">ifstream &amp;</td>          <td class="paramname"><span class="paramname"><em>fcontinue</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;</td>          <td class="paramname"><span class="paramname"><em>fld</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;</td>          <td class="paramname"><span class="paramname"><em>scl</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>tab</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>nxmin</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>nxmax</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>nymin</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>nymax</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>nzmin</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>nzmax</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>laymax</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>ln</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>jbs</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>kbs</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>lbs</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if parameters in the restart file match the current simulation setup. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fcontinue</td><td>Input file stream for the restart file (<code>out_all.dat</code>). </td></tr>
    <tr><td class="paramname">fld</td><td>Boolean indicating if fluid evolution is enabled (checked against file). </td></tr>
    <tr><td class="paramname">scl</td><td>Boolean indicating if scalar field evolution is enabled (checked against file). </td></tr>
    <tr><td class="paramname">tab</td><td>Number of ghost zones (checked against file). </td></tr>
    <tr><td class="paramname">nxmin</td><td>Minimum x-index (checked against file). </td></tr>
    <tr><td class="paramname">nxmax</td><td>Maximum x-index (checked against file). </td></tr>
    <tr><td class="paramname">nymin</td><td>Minimum y-index (checked against file). </td></tr>
    <tr><td class="paramname">nymax</td><td>Maximum y-index (checked against file). </td></tr>
    <tr><td class="paramname">nzmin</td><td>Minimum z-index (checked against file). </td></tr>
    <tr><td class="paramname">nzmax</td><td>Maximum z-index (checked against file). </td></tr>
    <tr><td class="paramname">laymax</td><td>Maximum allowed FMR layer number (checked against file's <code>ln</code>). </td></tr>
    <tr><td class="paramname">ln</td><td>Current FMR layer number (read from file). </td></tr>
    <tr><td class="paramname">jbs</td><td>Array of x-boundaries for FMR layers (checked against file). </td></tr>
    <tr><td class="paramname">kbs</td><td>Array of y-boundaries for FMR layers (checked against file). </td></tr>
    <tr><td class="paramname">lbs</td><td>Array of z-boundaries for FMR layers (checked against file).</td></tr>
  </table>
  </dd>
</dl>
<p>Reads header lines from the restart file (<code>out_all.dat</code>) and compares the stored parameters (like grid dimensions, enabled physics modules, FMR setup) against the parameters provided from the current run's configuration. If any mismatch is found, it prints an error message and exits the program. It also reads the number of layers (<code>ln</code>) present in the restart file. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cosmos__d_8cpp_a2e983e9a80d0d458a54647775b556278_icgraph.png" border="0" usemap="#acosmos__d_8cpp_a2e983e9a80d0d458a54647775b556278_icgraph" alt=""/></div>
<map name="acosmos__d_8cpp_a2e983e9a80d0d458a54647775b556278_icgraph" id="acosmos__d_8cpp_a2e983e9a80d0d458a54647775b556278_icgraph">
<area shape="rect" title="Checks if parameters in the restart file match the current simulation setup." alt="" coords="103,5,239,32"/>
<area shape="rect" href="cosmos__d_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function for the COSMOS simulation code." alt="" coords="5,5,55,32"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a45b1eecc3a25ffbc64e3666f6b6e0d57" name="a45b1eecc3a25ffbc64e3666f6b6e0d57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45b1eecc3a25ffbc64e3666f6b6e0d57">&#9670;&#160;</a></span>initial_fmr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initial_fmr </td>
          <td>(</td>
          <td class="paramtype">ifstream &amp;</td>          <td class="paramname"><span class="paramname"><em>fin</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>laymax</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>jbs</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>kbs</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>lbs</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>alp_fmr</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads Fixed Mesh Refinement (FMR) parameters from <code>par_fmr.d</code>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fin</td><td>Input file stream for <code>par_fmr.d</code>. </td></tr>
    <tr><td class="paramname">laymax</td><td>Maximum number of FMR layers allowed. </td></tr>
    <tr><td class="paramname">jbs</td><td>Array to store the x-index boundary for each FMR layer. </td></tr>
    <tr><td class="paramname">kbs</td><td>Array to store the y-index boundary for each FMR layer. </td></tr>
    <tr><td class="paramname">lbs</td><td>Array to store the z-index boundary for each FMR layer. </td></tr>
    <tr><td class="paramname">alp_fmr</td><td>Array to store the central lapse function value threshold for adding each FMR layer.</td></tr>
  </table>
  </dd>
</dl>
<p>Reads the maximum number of layers and then iteratively reads the grid index boundaries (j, k, l) and the lapse threshold (<code>alp_fmr</code>) for triggering the creation of each refinement layer. Aborts if the file cannot be opened. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cosmos__d_8cpp_a45b1eecc3a25ffbc64e3666f6b6e0d57_icgraph.png" border="0" usemap="#acosmos__d_8cpp_a45b1eecc3a25ffbc64e3666f6b6e0d57_icgraph" alt=""/></div>
<map name="acosmos__d_8cpp_a45b1eecc3a25ffbc64e3666f6b6e0d57_icgraph" id="acosmos__d_8cpp_a45b1eecc3a25ffbc64e3666f6b6e0d57_icgraph">
<area shape="rect" title="Reads Fixed Mesh Refinement (FMR) parameters from par_fmr.d." alt="" coords="103,5,180,32"/>
<area shape="rect" href="cosmos__d_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function for the COSMOS simulation code." alt="" coords="5,5,55,32"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a22a8364bf67f1752d82afb5a5bee7683" name="a22a8364bf67f1752d82afb5a5bee7683"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22a8364bf67f1752d82afb5a5bee7683">&#9670;&#160;</a></span>initial_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initial_read </td>
          <td>(</td>
          <td class="paramtype">ifstream &amp;</td>          <td class="paramname"><span class="paramname"><em>fin</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int &amp;</td>          <td class="paramname"><span class="paramname"><em>mstep</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>tmax</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>tab</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>amp</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>nxmin</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>nxmax</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>nymin</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>nymax</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>nzmin</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>nzmax</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>xmin</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>xmax</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>ymin</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>ymax</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>zmin</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>zmax</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>cfl</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>cdt</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>etaa</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>etab</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>etabb</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>KOep</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>exg</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>contn</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>file_continue</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>mu</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>kk</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>xi2</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>xi3</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>w3</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>mus</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>kks</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>xi2s</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>xi3s</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>Hb</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>fluidw</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>Mkap</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>bminmod</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>ptintval1</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>ptintval2</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>changept</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads simulation parameters from the main initialization file (<code>par_ini.d</code>). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fin</td><td>Input file stream for <code>par_ini.d</code>. </td></tr>
    <tr><td class="paramname">mstep</td><td>Maximum number of time steps. </td></tr>
    <tr><td class="paramname">tmax</td><td>Maximum simulation time. </td></tr>
    <tr><td class="paramname">tab</td><td>Number of ghost zones. </td></tr>
    <tr><td class="paramname">amp</td><td>Amplitude parameter for inhomogeneous grid stretching. </td></tr>
    <tr><td class="paramname">nxmin</td><td>Minimum x-index. </td></tr>
    <tr><td class="paramname">nxmax</td><td>Maximum x-index. </td></tr>
    <tr><td class="paramname">nymin</td><td>Minimum y-index. </td></tr>
    <tr><td class="paramname">nymax</td><td>Maximum y-index. </td></tr>
    <tr><td class="paramname">nzmin</td><td>Minimum z-index. </td></tr>
    <tr><td class="paramname">nzmax</td><td>Maximum z-index. </td></tr>
    <tr><td class="paramname">xmin</td><td>Minimum x-coordinate. </td></tr>
    <tr><td class="paramname">xmax</td><td>Maximum x-coordinate. </td></tr>
    <tr><td class="paramname">ymin</td><td>Minimum y-coordinate. </td></tr>
    <tr><td class="paramname">ymax</td><td>Maximum y-coordinate. </td></tr>
    <tr><td class="paramname">zmin</td><td>Minimum z-coordinate. </td></tr>
    <tr><td class="paramname">zmax</td><td>Maximum z-coordinate. </td></tr>
    <tr><td class="paramname">cfl</td><td>CFL factor for time step calculation. </td></tr>
    <tr><td class="paramname">cdt</td><td>Cosmological time scale factor for time step. </td></tr>
    <tr><td class="paramname">etaa</td><td>Gauge parameter eta_alpha for 1+log slicing. </td></tr>
    <tr><td class="paramname">etab</td><td>Gauge parameter eta_beta for Gamma-driver shift. </td></tr>
    <tr><td class="paramname">etabb</td><td>Gauge parameter eta_B for Gamma-driver shift. </td></tr>
    <tr><td class="paramname">KOep</td><td>Coefficient for Kreiss-Oliger dissipation. </td></tr>
    <tr><td class="paramname">exg</td><td>Grid index for excision boundary (if used). </td></tr>
    <tr><td class="paramname">contn</td><td>Flag indicating whether to continue from a restart file (1=yes, 0=no). </td></tr>
    <tr><td class="paramname">file_continue</td><td>Name of the restart file (e.g., "out_all.dat"). </td></tr>
    <tr><td class="paramname">mu</td><td>Amplitude of the initial metric perturbation. </td></tr>
    <tr><td class="paramname">kk</td><td>Wavenumber/scale of the initial metric perturbation. </td></tr>
    <tr><td class="paramname">xi2</td><td>Non-sphericity parameter 1 for metric perturbation. </td></tr>
    <tr><td class="paramname">xi3</td><td>Non-sphericity parameter 2 for metric perturbation. </td></tr>
    <tr><td class="paramname">w3</td><td>Non-sphericity parameter 3 for metric perturbation. </td></tr>
    <tr><td class="paramname">mus</td><td>Amplitude of the initial scalar field perturbation. </td></tr>
    <tr><td class="paramname">kks</td><td>Wavenumber/scale of the initial scalar field perturbation. </td></tr>
    <tr><td class="paramname">xi2s</td><td>Non-sphericity parameter 1 for scalar field perturbation Laplacian. </td></tr>
    <tr><td class="paramname">xi3s</td><td>Non-sphericity parameter 2 for scalar field perturbation Laplacian. </td></tr>
    <tr><td class="paramname">Hb</td><td>Initial Hubble parameter. </td></tr>
    <tr><td class="paramname">fluidw</td><td>Equation of state parameter (w = P/rho) for the fluid. </td></tr>
    <tr><td class="paramname">Mkap</td><td>Kappa parameter for MUSCL reconstruction in fluid dynamics. </td></tr>
    <tr><td class="paramname">bminmod</td><td>Beta parameter for the minmod limiter in fluid dynamics. </td></tr>
    <tr><td class="paramname">ptintval1</td><td>Initial time interval for printing output. </td></tr>
    <tr><td class="paramname">ptintval2</td><td>Secondary time interval for printing output. </td></tr>
    <tr><td class="paramname">changept</td><td>Time at which the printing interval switches from ptintval1 to ptintval2.</td></tr>
  </table>
  </dd>
</dl>
<p>Reads parameters line by line from <code>par_ini.d</code>, skipping comment lines starting with '#'. Uses <code>sscanf</code> to parse values. Aborts if the file cannot be opened. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cosmos__d_8cpp_a22a8364bf67f1752d82afb5a5bee7683_icgraph.png" border="0" usemap="#acosmos__d_8cpp_a22a8364bf67f1752d82afb5a5bee7683_icgraph" alt=""/></div>
<map name="acosmos__d_8cpp_a22a8364bf67f1752d82afb5a5bee7683_icgraph" id="acosmos__d_8cpp_a22a8364bf67f1752d82afb5a5bee7683_icgraph">
<area shape="rect" title="Reads simulation parameters from the main initialization file (par_ini.d)." alt="" coords="103,5,186,32"/>
<area shape="rect" href="cosmos__d_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function for the COSMOS simulation code." alt="" coords="5,5,55,32"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a0ddf1224851353fc92bfbff6f499fa97" name="a0ddf1224851353fc92bfbff6f499fa97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ddf1224851353fc92bfbff6f499fa97">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>argc</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>argv</em>[]</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main function for the COSMOS simulation code. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">argc</td><td>Number of command-line arguments. </td></tr>
    <tr><td class="paramname">argv</td><td>Array of command-line arguments. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on successful completion. Exits with non-zero status on error.</dd></dl>
<p>This is the main driver routine for the simulation. It performs the following steps:</p><ol type="1">
<li>Reads simulation parameters from <code>par_ini.d</code>, <code>par_fmr.d</code>, and <code>par_ahf.d</code>.</li>
<li>Initializes the base grid (<code><a class="el" href="class_fmv.html" title="Derived class from Fmv0, implementing specific boundary conditions and initial data routines for the ...">Fmv</a></code>) and potentially higher FMR layers (<code><a class="el" href="class_fmv1.html" title="Derived class from Fmv0, implementing Fixed Mesh Refinement (FMR).">Fmv1</a></code>).</li>
<li>Initializes the Apparent Horizon Finder (<code><a class="el" href="class_ahf2d.html" title="Implements a 2D Apparent Horizon Finder.">Ahf2d</a></code>).</li>
<li>Sets up initial data, either from scratch using parameters or by loading from a restart file (<code>out_all.dat</code>).</li>
<li>Enters the main time evolution loop (using 4th-order Runge-Kutta via <code>BSSN</code> calls).</li>
<li>Manages the addition and evolution of FMR layers based on central lapse values.</li>
<li>Periodically calls the AHF to search for and track apparent horizons.</li>
<li>Handles output of data slices, constraints, AH properties, and full restart files.</li>
<li>Performs final checks and cleanup. </li>
</ol>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cosmos__d_8cpp_a0ddf1224851353fc92bfbff6f499fa97_cgraph.png" border="0" usemap="#acosmos__d_8cpp_a0ddf1224851353fc92bfbff6f499fa97_cgraph" alt=""/></div>
<map name="acosmos__d_8cpp_a0ddf1224851353fc92bfbff6f499fa97_cgraph" id="acosmos__d_8cpp_a0ddf1224851353fc92bfbff6f499fa97_cgraph">
<area shape="rect" title="Main function for the COSMOS simulation code." alt="" coords="5,183,55,209"/>
<area shape="rect" href="cosmos__d_8cpp.html#a372542cc94148e0fa873200daaceaa6e" title="Reads Apparent Horizon Finder (AHF) parameters from par_ahf.d." alt="" coords="135,5,207,32"/>
<area shape="poly" title=" " alt="" coords="32,181,53,116,73,77,101,42,119,30,122,34,104,46,77,79,57,118,37,183"/>
<area shape="rect" href="cosmos__d_8cpp.html#a2e983e9a80d0d458a54647775b556278" title="Checks if parameters in the restart file match the current simulation setup." alt="" coords="103,56,239,83"/>
<area shape="poly" title=" " alt="" coords="35,181,60,138,79,114,101,93,107,88,110,92,104,97,83,117,65,141,40,184"/>
<area shape="rect" href="class_ahf2d.html#a25a6ad994349e7c3a0f1b6d8c8e3931e" title="Main function to find the apparent horizon." alt="" coords="118,107,224,133"/>
<area shape="poly" title=" " alt="" coords="47,180,101,143,113,137,115,142,104,148,50,184"/>
<area shape="rect" href="cosmos__d_8cpp.html#a45b1eecc3a25ffbc64e3666f6b6e0d57" title="Reads Fixed Mesh Refinement (FMR) parameters from par_fmr.d." alt="" coords="132,157,210,184"/>
<area shape="poly" title=" " alt="" coords="54,189,116,178,117,183,55,194"/>
<area shape="rect" href="class_fmv.html#a6465e510a50b2e09fe52c59e9e336b28" title="Sets the initial data for the geometric (BSSN) variables with non&#45;spherical perturbations." alt="" coords="104,208,238,235"/>
<area shape="poly" title=" " alt="" coords="55,198,89,204,88,209,54,203"/>
<area shape="rect" href="cosmos__d_8cpp.html#a22a8364bf67f1752d82afb5a5bee7683" title="Reads simulation parameters from the main initialization file (par_ini.d)." alt="" coords="129,259,213,285"/>
<area shape="poly" title=" " alt="" coords="50,208,104,244,116,250,114,255,101,249,47,212"/>
<area shape="rect" href="cosmos__d_8cpp.html#a62d7edea0dd4c86b24de88f3daf396da" title="Writes essential simulation parameters to the header of the restart file." alt="" coords="117,309,225,336"/>
<area shape="poly" title=" " alt="" coords="40,208,65,251,83,275,104,295,110,300,107,304,101,299,79,278,60,254,35,211"/>
<area shape="rect" href="cosmos__d_8cpp.html#af2e605489a657ae790c8647e638e8238" title="Helper function to call print routines for all active grid layers." alt="" coords="134,360,208,387"/>
<area shape="poly" title=" " alt="" coords="37,209,57,274,77,313,104,346,120,357,117,361,101,350,73,315,53,276,32,211"/>
</map>
</div>

</div>
</div>
<a id="a62d7edea0dd4c86b24de88f3daf396da" name="a62d7edea0dd4c86b24de88f3daf396da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62d7edea0dd4c86b24de88f3daf396da">&#9670;&#160;</a></span>output_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void output_params </td>
          <td>(</td>
          <td class="paramtype">ofstream &amp;</td>          <td class="paramname"><span class="paramname"><em>fileall</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;</td>          <td class="paramname"><span class="paramname"><em>fld</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;</td>          <td class="paramname"><span class="paramname"><em>scl</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>tab</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>nxmin</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>nxmax</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>nymin</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>nymax</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>nzmin</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>nzmax</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>laymax</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>ln</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>jbs</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>kbs</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>lbs</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes essential simulation parameters to the header of the restart file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fileall</td><td>Output file stream for the restart file (<code>out_all.dat</code>). </td></tr>
    <tr><td class="paramname">fld</td><td>Boolean indicating if fluid evolution is enabled. </td></tr>
    <tr><td class="paramname">scl</td><td>Boolean indicating if scalar field evolution is enabled. </td></tr>
    <tr><td class="paramname">tab</td><td>Number of ghost zones. </td></tr>
    <tr><td class="paramname">nxmin</td><td>Minimum x-index. </td></tr>
    <tr><td class="paramname">nxmax</td><td>Maximum x-index. </td></tr>
    <tr><td class="paramname">nymin</td><td>Minimum y-index. </td></tr>
    <tr><td class="paramname">nymax</td><td>Maximum y-index. </td></tr>
    <tr><td class="paramname">nzmin</td><td>Minimum z-index. </td></tr>
    <tr><td class="paramname">nzmax</td><td>Maximum z-index. </td></tr>
    <tr><td class="paramname">laymax</td><td>Maximum allowed FMR layer number (informational, not strictly needed for restart). </td></tr>
    <tr><td class="paramname">ln</td><td>Current FMR layer number being saved. </td></tr>
    <tr><td class="paramname">jbs</td><td>Array of x-boundaries for FMR layers. </td></tr>
    <tr><td class="paramname">kbs</td><td>Array of y-boundaries for FMR layers. </td></tr>
    <tr><td class="paramname">lbs</td><td>Array of z-boundaries for FMR layers.</td></tr>
  </table>
  </dd>
</dl>
<p>Writes specially formatted comment lines (<code>##key=value</code>) at the beginning of the <code>out_all.dat</code> file. These lines store crucial parameters needed to correctly interpret the data during a restart, ensuring consistency. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cosmos__d_8cpp_a62d7edea0dd4c86b24de88f3daf396da_icgraph.png" border="0" usemap="#acosmos__d_8cpp_a62d7edea0dd4c86b24de88f3daf396da_icgraph" alt=""/></div>
<map name="acosmos__d_8cpp_a62d7edea0dd4c86b24de88f3daf396da_icgraph" id="acosmos__d_8cpp_a62d7edea0dd4c86b24de88f3daf396da_icgraph">
<area shape="rect" title="Writes essential simulation parameters to the header of the restart file." alt="" coords="103,5,210,32"/>
<area shape="rect" href="cosmos__d_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function for the COSMOS simulation code." alt="" coords="5,5,55,32"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="af2e605489a657ae790c8647e638e8238" name="af2e605489a657ae790c8647e638e8238"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2e605489a657ae790c8647e638e8238">&#9670;&#160;</a></span>printpack()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void printpack </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_fmv0.html">Fmv0</a> **</td>          <td class="paramname"><span class="paramname"><em>fmv0</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>ln</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>pk</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>pl</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ofstream &amp;</td>          <td class="paramname"><span class="paramname"><em>filex</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ofstream &amp;</td>          <td class="paramname"><span class="paramname"><em>filey</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ofstream &amp;</td>          <td class="paramname"><span class="paramname"><em>filez</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ofstream &amp;</td>          <td class="paramname"><span class="paramname"><em>filex0z</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ofstream &amp;</td>          <td class="paramname"><span class="paramname"><em>filexy0</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Helper function to call print routines for all active grid layers. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fmv0</td><td>Array of pointers to <a class="el" href="class_fmv0.html" title="Base class for Finite Mesh Variables version 0.">Fmv0</a> objects (grid hierarchy). </td></tr>
    <tr><td class="paramname">ln</td><td>Current highest layer index. </td></tr>
    <tr><td class="paramname">pk</td><td>Y-index for slices. </td></tr>
    <tr><td class="paramname">pl</td><td>Z-index for slices. </td></tr>
    <tr><td class="paramname">filex</td><td>Output stream for x-slices. </td></tr>
    <tr><td class="paramname">filey</td><td>Output stream for y-slices. </td></tr>
    <tr><td class="paramname">filez</td><td>Output stream for z-slices. </td></tr>
    <tr><td class="paramname">filex0z</td><td>Output stream for xz-plane slices. </td></tr>
    <tr><td class="paramname">filexy0</td><td>Output stream for xy-plane slices.</td></tr>
  </table>
  </dd>
</dl>
<p>Iterates through the grid hierarchy, calls <code>dyntoprim</code> if needed, and then calls the respective print methods (<code>print_x</code>, <code>print_y</code>, <code>print_z</code>, <code>print_xz</code>, <code>print_xy</code>) for each layer. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cosmos__d_8cpp_af2e605489a657ae790c8647e638e8238_icgraph.png" border="0" usemap="#acosmos__d_8cpp_af2e605489a657ae790c8647e638e8238_icgraph" alt=""/></div>
<map name="acosmos__d_8cpp_af2e605489a657ae790c8647e638e8238_icgraph" id="acosmos__d_8cpp_af2e605489a657ae790c8647e638e8238_icgraph">
<area shape="rect" title="Helper function to call print routines for all active grid layers." alt="" coords="103,5,177,32"/>
<area shape="rect" href="cosmos__d_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function for the COSMOS simulation code." alt="" coords="5,5,55,32"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
